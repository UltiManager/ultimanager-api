---
dist: xenial

matrix:
  include:
    # Test suite for the application itself
    - language: python
      python: 3.7

      cache: pip

      env:
        - SECRET_KEY=test

      install:
        - pip install --upgrade pip
        - pip install --upgrade pipenv
        - pipenv sync --dev

      script:
        - pipenv run black --check .
        - pipenv run flake8

      after_success:
        - pipenv run coverage combine
        - pipenv run codecov

    # Test building the docker image
    - language: minimal

      services:
        - docker

      script:
        - docker build -t ultimanager-web .


notifications:
  email:
    on_failure: always
    on_success: never
